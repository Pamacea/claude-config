# Vite Patterns & Best Practices

> **Version:** 2.0.0 | **Category:** Cat 4 (Patterns RÃ©utilisables) | **Difficulty:** Beginner
> **Auto-Activation:** "vite", "build tool", "bundler", "dev server", "hmr", "fast refresh"
> **Tags:** [vite, build-tool, bundler, dev-server, hmr]
> **Related:** nextjs-patterns, typescript-patterns, tailwind-patterns
> **Last Updated:** 2025-02-24

---

## ğŸš€ Quick Start

```bash
# Create new project
npm create vite@latest my-app --template react-ts
cd my-app
npm run dev
```

---

## ğŸ“ Project Structure

```
src/
â”œâ”€â”€ main.tsx              # Entry point
â”œâ”€â”€ vite-env.d.ts        # Vite types
â”œâ”€â”€ assets/              # Static assets
â””â”€â”€ styles/              # Global styles
```

---

## âš™ï¸ Configuration

### vite.config.ts

```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  server: {
    port: 3000,
    open: true,
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
  },
})
```

---

## ğŸ”Œ Plugins Essentiels

```typescript
import react from '@vitejs/plugin-react'
import dts from 'vite-plugin-dts'

export default defineConfig({
  plugins: [
    react(),
    dts(),
  ],
})
```

---

## ğŸ¯ Best Practices

- âœ… Use `@` alias for imports
- âœ… Enable sourcemap in dev
- âœ… Use `environment` dir for .env files
- âœ… Configure proper `lib` targets for browsers

---

## âš ï¸ Anti-Patterns

| âŒ NEVER | âœ… ALWAYS | Why |
|---------|-----------|-----|
| Using `import.meta.env` directly | `VITE_` prefixed env vars | Vite only exposes vars with `VITE_` prefix |
| Not using alias imports | `@/` alias for clean imports | Cleaner import paths |
| Ignoring build optimization | Proper build config | Faster, smaller bundles |
| Not configuring proxy | Proxy API calls during dev | Avoid CORS issues |
| Manual bundling | Let Vite handle bundling | Vite is optimized by default |
| Ignoring HMR issues | Proper HMR configuration | Fast development experience |

---

## ğŸ”§ Troubleshooting

| Problem | Cause | Solution |
|---------|-------|----------|
| **"Environment variable undefined"** | Missing `VITE_` prefix | Rename to `VITE_Your_Var` |
| **"Module not found"** | Wrong alias configuration | Check `resolve.alias` in vite.config |
| **"HMR not working"** | Missing or wrong HMR config | Ensure HMR enabled in server config |
| **"Build too slow"** | Not optimizing dependencies | Use `optimizeDeps.include` |
| **"Port already in use"** | Server port conflict | Change `server.port` in config |
| **"Assets not loading"** | Wrong public directory | Put assets in `public/` folder |

---

## ğŸ”— Related Skills

- **Related:** `nextjs-patterns` - Next.js has built-in bundling (vs Vite)
- **Related:** `tailwind-patterns` - Tailwind pairs perfectly with Vite
- **Related:** `typescript-patterns` - Vite + TypeScript = excellent DX

---

## ğŸ“– Further Reading

- [Official Vite Documentation](https://vitejs.dev/)
- [Vite Plugins](https://vitejs.dev/plugins/)
- [Vite Configuration](https://vitejs.dev/config/)
- [Why Vite](https://vitejs.dev/guide/why.html)

---

## ğŸ¯ Success Criteria

Vite implementation is complete when:
- [ ] Vite properly configured for framework
- [ ] Path aliases working (`@/` imports)
- [ ] Environment variables using `VITE_` prefix
- [ ] HMR working smoothly
- [ ] Build optimized for production
- [ ] Proxy configured for API calls
- [ ] Source maps enabled in dev
- [ ] Fast development experience

---

## ğŸ’¡ Key Insights

### Why Vite Works Well

1. **Instant Start** - No bundling during dev
2. **Lightning Fast HMR** - Updates in milliseconds
3. **Optimized Build** - Rollup for production
4. **Framework Agnostic** - Works with React, Vue, Svelte, etc.
5. **Native ESM** - Uses browser native modules

### Common Pitfalls

- âŒ **Pitfall:** Forgetting `VITE_` prefix for env vars
  â†’ **Fix:** Always prefix environment variables with `VITE_`

- âŒ **Pitfall:** Not using path aliases
  â†’ **Fix:** Configure `@` alias for cleaner imports

- âŒ **Pitfall:** Ignoring dependency optimization
  â†’ **Fix:** Pre-bundle dependencies for faster dev

---

*Version: 2.0.0 | Vite Patterns*
